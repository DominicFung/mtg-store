{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Dom/Projects/mtg-store/web/app/box/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { Rnd } from \"react-rnd\";\n\ninterface Props {\n  imageSrc: string;\n}\n\nconst ASPECT_RATIO = 4 / 5;\nconst BOX_COUNT = 3;\n\nexport default function ImageCropper({ imageSrc }: Props) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [imgDimensions, setImgDimensions] = useState({ width: 0, height: 0 });\n\n  const [boxes, setBoxes] = useState(\n    Array.from({ length: BOX_COUNT }, (_, i) => ({\n      x: i * 120,\n      y: 50,\n      width: 120,\n      height: 120 / ASPECT_RATIO,\n    }))\n  );\n\n  const handleBoxChange = (index: number, data: any) => {\n    const newBoxes = [...boxes];\n    newBoxes[index] = {\n      ...newBoxes[index],\n      ...data,\n    };\n    setBoxes(newBoxes);\n  };\n\n  return (\n    <div className=\"relative mt-4\" ref={containerRef}>\n      <img\n        src={imageSrc}\n        alt=\"Uploaded\"\n        onLoad={(e) => {\n          const { width, height } = e.currentTarget;\n          setImgDimensions({ width, height });\n        }}\n        style={{ width: \"100%\", maxWidth: \"800px\" }}\n      />\n\n      {/* Overlay box layer */}\n      <div\n        className=\"absolute top-0 left-0\"\n        style={{\n          width: imgDimensions.width,\n          height: imgDimensions.height,\n        }}\n      >\n        {boxes.map((box, i) => (\n          <Rnd\n            key={i}\n            size={{ width: box.width, height: box.height }}\n            position={{ x: box.x, y: box.y }}\n            onDragStop={(_, d) => handleBoxChange(i, { x: d.x, y: d.y })}\n            onResizeStop={(_, __, ref, ___, pos) =>\n              handleBoxChange(i, {\n                width: parseFloat(ref.style.width),\n                height: parseFloat(ref.style.height),\n                x: pos.x,\n                y: pos.y,\n              })\n            }\n            lockAspectRatio={ASPECT_RATIO}\n            bounds=\"parent\"\n            style={{\n              border: \"2px solid red\",\n              zIndex: 10,\n              position: \"absolute\",\n            }}\n          />\n        ))}\n      </div>\n\n      {/* Crop + export */}\n      <button\n        className=\"mt-4 px-4 py-2 bg-blue-500 text-white rounded\"\n        onClick={async () => {\n          const img = new Image();\n          img.src = imageSrc;\n          await img.decode();\n\n          boxes.forEach((box, i) => {\n            const canvas = document.createElement(\"canvas\");\n            const scaleX = img.naturalWidth / imgDimensions.width;\n            const scaleY = img.naturalHeight / imgDimensions.height;\n\n            canvas.width = box.width * scaleX;\n            canvas.height = box.height * scaleY;\n            const ctx = canvas.getContext(\"2d\")!;\n            ctx.drawImage(\n              img,\n              box.x * scaleX,\n              box.y * scaleY,\n              box.width * scaleX,\n              box.height * scaleY,\n              0,\n              0,\n              canvas.width,\n              canvas.height\n            );\n\n            // Example: Show cropped canvas\n            const dataURL = canvas.toDataURL(\"image/png\");\n            const preview = new Image();\n            preview.src = dataURL;\n            document.body.appendChild(preview);\n          });\n        }}\n      >\n        Crop Images\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AASA,MAAM,eAAe,IAAI;AACzB,MAAM,YAAY;AAEH,SAAS,aAAa,EAAE,QAAQ,EAAS;;IACtD,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAC5C,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;QAAE,OAAO;QAAG,QAAQ;IAAE;IAEzE,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAC/B,MAAM,IAAI,CAAC;QAAE,QAAQ;IAAU;iCAAG,CAAC,GAAG,IAAM,CAAC;gBAC3C,GAAG,IAAI;gBACP,GAAG;gBACH,OAAO;gBACP,QAAQ,MAAM;YAChB,CAAC;;IAGH,MAAM,kBAAkB,CAAC,OAAe;QACtC,MAAM,WAAW;eAAI;SAAM;QAC3B,QAAQ,CAAC,MAAM,GAAG;YAChB,GAAG,QAAQ,CAAC,MAAM;YAClB,GAAG,IAAI;QACT;QACA,SAAS;IACX;IAEA,qBACE,6LAAC;QAAI,WAAU;QAAgB,KAAK;;0BAClC,6LAAC;gBACC,KAAK;gBACL,KAAI;gBACJ,QAAQ,CAAC;oBACP,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,aAAa;oBACzC,iBAAiB;wBAAE;wBAAO;oBAAO;gBACnC;gBACA,OAAO;oBAAE,OAAO;oBAAQ,UAAU;gBAAQ;;;;;;0BAI5C,6LAAC;gBACC,WAAU;gBACV,OAAO;oBACL,OAAO,cAAc,KAAK;oBAC1B,QAAQ,cAAc,MAAM;gBAC9B;0BAEC,MAAM,GAAG,CAAC,CAAC,KAAK,kBACf,6LAAC,+IAAA,CAAA,MAAG;wBAEF,MAAM;4BAAE,OAAO,IAAI,KAAK;4BAAE,QAAQ,IAAI,MAAM;wBAAC;wBAC7C,UAAU;4BAAE,GAAG,IAAI,CAAC;4BAAE,GAAG,IAAI,CAAC;wBAAC;wBAC/B,YAAY,CAAC,GAAG,IAAM,gBAAgB,GAAG;gCAAE,GAAG,EAAE,CAAC;gCAAE,GAAG,EAAE,CAAC;4BAAC;wBAC1D,cAAc,CAAC,GAAG,IAAI,KAAK,KAAK,MAC9B,gBAAgB,GAAG;gCACjB,OAAO,WAAW,IAAI,KAAK,CAAC,KAAK;gCACjC,QAAQ,WAAW,IAAI,KAAK,CAAC,MAAM;gCACnC,GAAG,IAAI,CAAC;gCACR,GAAG,IAAI,CAAC;4BACV;wBAEF,iBAAiB;wBACjB,QAAO;wBACP,OAAO;4BACL,QAAQ;4BACR,QAAQ;4BACR,UAAU;wBACZ;uBAlBK;;;;;;;;;;0BAwBX,6LAAC;gBACC,WAAU;gBACV,SAAS;oBACP,MAAM,MAAM,IAAI;oBAChB,IAAI,GAAG,GAAG;oBACV,MAAM,IAAI,MAAM;oBAEhB,MAAM,OAAO,CAAC,CAAC,KAAK;wBAClB,MAAM,SAAS,SAAS,aAAa,CAAC;wBACtC,MAAM,SAAS,IAAI,YAAY,GAAG,cAAc,KAAK;wBACrD,MAAM,SAAS,IAAI,aAAa,GAAG,cAAc,MAAM;wBAEvD,OAAO,KAAK,GAAG,IAAI,KAAK,GAAG;wBAC3B,OAAO,MAAM,GAAG,IAAI,MAAM,GAAG;wBAC7B,MAAM,MAAM,OAAO,UAAU,CAAC;wBAC9B,IAAI,SAAS,CACX,KACA,IAAI,CAAC,GAAG,QACR,IAAI,CAAC,GAAG,QACR,IAAI,KAAK,GAAG,QACZ,IAAI,MAAM,GAAG,QACb,GACA,GACA,OAAO,KAAK,EACZ,OAAO,MAAM;wBAGf,+BAA+B;wBAC/B,MAAM,UAAU,OAAO,SAAS,CAAC;wBACjC,MAAM,UAAU,IAAI;wBACpB,QAAQ,GAAG,GAAG;wBACd,SAAS,IAAI,CAAC,WAAW,CAAC;oBAC5B;gBACF;0BACD;;;;;;;;;;;;AAKP;GA3GwB;KAAA","debugId":null}}]
}